<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pie Chart</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        canvas {
            width: 300px;
            height: 300px;
        }
    </style>
</head>
<body>
    <canvas id="html1"></canvas>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const canvas = document.getElementById('html1');
        if (canvas) {
            // Obtenha o ID do imóvel da URL da página dinâmica
            const itemId = new URLSearchParams(window.location.search).get("itemId");

            // Verifique se itemId está presente
            if (!itemId) {
                console.error('Item ID não encontrado na URL.');
                return;
            }

            // Construa a URL com o itemId para buscar os dados
            const dataUrl = `https://limpaimovel.com.br/_functions/myChartData?itemId=${itemId}`;

            fetch(dataUrl)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok: ' + response.statusText);
                }
                return response.json();
            })
            .then(data => {
                const ctx = canvas.getContext('2d');
                const myPieChart = new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: ['Frações restantes', 'Fração adquirida'],
                        datasets: [{
                            data: [parseFloat(data.outraParte), parseFloat(data.suaParte)],
                            backgroundColor: ['#00C4F5', '#0E344A'],
                            hoverBackgroundColor: ['#AAEEFF', '#B1D8E3']
                        }]
                    },
                    options: {
                        responsive: true,
                        legend: {
                            display: false  // Desativa a exibição da legenda
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Error loading the data:', error);
                alert('Error loading the data: ' + error.message);
            });
        } else {
            console.error('Canvas element not found!');
        }
    });
    </script>
</body>
</html>


